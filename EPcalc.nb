(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    101327,       2520]
NotebookOptionsPosition[     95388,       2412]
NotebookOutlinePosition[     96002,       2433]
CellTagsIndexPosition[     95959,       2430]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Entanglement power calculator",
 FontSize->24]], "Title",
 CellChangeTimes->{{3.943254944116823*^9, 3.9432549499019527`*^9}, {
  3.9504096076654434`*^9, 
  3.9504096107025127`*^9}},ExpressionUUID->"62d9c5db-de1f-9a47-b9cd-\
cb2e49d0552e"],

Cell["Tao-Ran Hu", "Author",
 CellChangeTimes->{{3.9432549569742317`*^9, 
  3.9432549601976833`*^9}},ExpressionUUID->"723aa07e-624e-fa43-a9c3-\
c33090ecb45f"],

Cell["December 2024", "Date",
 CellChangeTimes->{{3.943254968932644*^9, 
  3.943254973220127*^9}},ExpressionUUID->"74f11d97-fcb1-d141-bf08-\
3e68d5341a77"],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.544441890113204*^9, 3.544441890674237*^9}, {
  3.9432549305348263`*^9, 3.943254932756584*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"e954a9e0-d0e2-46af-a905-7ced7dc10471"],

Cell[CellGroupData[{

Cell["Useful definitions", "Section",
 CellChangeTimes->{{3.9448805199227753`*^9, 
  3.944880531039751*^9}},ExpressionUUID->"98b4a004-41dd-7f40-8617-\
2f1d5a738672"],

Cell[CellGroupData[{

Cell["PrintTime from Maeder\[CloseCurlyQuote]s book", "Subsection",
 CellChangeTimes->{
  3.9448819530161247`*^9},ExpressionUUID->"2c353790-d81e-574e-8fad-\
aacfcb0da47f"],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"PrintTime", ",", "HoldAll"}], "]"}], "\n", 
 RowBox[{
  RowBox[{"PrintTime", "[", "expr_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"timing", "=", 
      RowBox[{"Timing", "[", "expr", "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Time used: \>\"", ",", 
       RowBox[{"timing", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< seconds\>\""}], "]"}], ";", 
     RowBox[{"timing", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.944880533580015*^9, 3.9448805940522766`*^9}, {
   3.944880744555599*^9, 3.944880745463127*^9}, {3.9448808154893036`*^9, 
   3.94488083240658*^9}, 3.944880867207346*^9, {3.9448809514054317`*^9, 
   3.944880952282013*^9}, 3.9448814252490444`*^9, 3.944881517804384*^9, {
   3.9448815563751144`*^9, 3.944881586145693*^9}, {3.9448819619903374`*^9, 
   3.94488196374378*^9}, {3.946522606180908*^9, 3.946522612283676*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8b1dcab6-39f3-594d-8aaf-6d538be5d8b0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generators", "Section",
 CellChangeTimes->{{3.572909074547361*^9, 3.5729091119803343`*^9}, {
  3.9432556697263813`*^9, 
  3.9432556750335655`*^9}},ExpressionUUID->"223357e4-6f64-457b-bba5-\
59cdca655b8d"],

Cell[CellGroupData[{

Cell["su2 irreps", "Subsection",
 CellChangeTimes->{
  3.943306543712225*^9},ExpressionUUID->"9ca0a207-aaf5-1f4a-a843-\
5e1b600fc46f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]", "[", "j_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ms", ",", "\[Sigma]z", ",", "\[Sigma]p", ",", "\[Sigma]m", ",", 
       "\[Sigma]x", ",", "\[Sigma]y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ms", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"m", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "j", ",", 
           RowBox[{"-", "j"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]z", "=", 
       RowBox[{"DiagonalMatrix", "[", "ms", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]p", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m1", "==", 
            RowBox[{"m2", "+", "1"}]}], ",", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "m2"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"j", "+", "m2", "+", "1"}], ")"}]}], "]"}], ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", "ms"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m2", ",", "ms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]m", "=", 
       RowBox[{"Transpose", "[", "\[Sigma]p", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]x", "=", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{"\[Sigma]p", "+", "\[Sigma]m"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]y", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "I"}], "/", "2"}], 
        RowBox[{"(", 
         RowBox[{"\[Sigma]p", "-", "\[Sigma]m"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[Sigma]x", ",", "\[Sigma]y", ",", "\[Sigma]z"}], "}"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.572912579745871*^9, 3.5729126196675053`*^9}, {
  3.9432564462033367`*^9, 3.9432564513137474`*^9}, {3.943256494820175*^9, 
  3.9432565155936146`*^9}, {3.943256645493124*^9, 3.943256663116022*^9}, {
  3.9432569006856365`*^9, 3.9432569372483883`*^9}, {3.9432571549589405`*^9, 
  3.943257155349415*^9}, {3.9432572723381557`*^9, 3.943257392432392*^9}, {
  3.9433065392213*^9, 3.943306540301756*^9}, {3.9434207515662727`*^9, 
  3.9434207580031548`*^9}, {3.943437679092087*^9, 3.943437681473425*^9}, {
  3.944974254263109*^9, 3.9449742545911617`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"26956892-69bf-4a1e-bcc2-b9178ce5f14d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Casimir operators", "Subsection",
 CellChangeTimes->{{3.943500230808855*^9, 
  3.943500248993004*^9}},ExpressionUUID->"c189ece0-bb0d-f54e-9def-\
3a0a613d6f9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"JJ", "[", 
    RowBox[{"J1_", ",", "J2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "sum", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sum", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"MapThread", "[", 
         RowBox[{"KroneckerProduct", ",", 
          RowBox[{"{", 
           RowBox[{"J1", ",", "J2"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "sum"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.943500233890976*^9, 3.9435002406695194`*^9}, {
  3.943500270782467*^9, 3.943500272113014*^9}, {3.9453263789354115`*^9, 
  3.9453263898405056`*^9}, {3.9454785049909363`*^9, 3.945478505777817*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"f53db56d-8a57-4249-88da-92c99cfb528e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Entanglement power calculator", "Section",
 CellChangeTimes->{{3.9435043966781406`*^9, 3.943504402251339*^9}, {
  3.9448956180658894`*^9, 
  3.9448956223393917`*^9}},ExpressionUUID->"ee20c56c-3c27-ef4e-97cd-\
522ad387f88d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EPcalc", "[", 
    RowBox[{"S_", ",", "l_Integer", ",", "m_Integer", ",", "n_Integer"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dimension", ",", "theta1", ",", "phi1", ",", "theta2", ",", "phi2", 
       ",", "integrand", ",", "limits", ",", "integral1", ",", "integral2"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"l", ":", " ", "weight"}], ";", " ", 
       RowBox[{
        RowBox[{"m", " ", "&"}], " ", 
        RowBox[{"n", ":", " ", "dimensions"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dimension", "=", 
       RowBox[{"Dimensions", "[", "S", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dimension", "]"}], "!=", "2"}], "||", 
         RowBox[{
          RowBox[{"dimension", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "!=", 
          RowBox[{"dimension", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "||", 
         RowBox[{
          RowBox[{"dimension", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "!=", 
          RowBox[{"m", " ", "n"}]}]}], ",", 
        RowBox[{"Return", "[", "\"\<Shape mismatched\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "parameters", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theta1", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"\[Theta]", ",", "1"}], "]"}], ",", 
            RowBox[{"m", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"phi1", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"\[Phi]", ",", "1"}], "]"}], ",", 
            RowBox[{"m", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"theta2", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"\[Theta]", ",", "2"}], "]"}], ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"phi2", "=", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"\[Phi]", ",", "2"}], "]"}], ",", 
            RowBox[{"n", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "integrand", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"integrand", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"theta1", ",", "phi1", ",", "theta2", ",", "phi2"}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Assuming", "[", 
             RowBox[{
              RowBox[{"And", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Element", "[", 
                   RowBox[{"#", ",", "Reals"}], "]"}], "&"}], "/@", 
                 RowBox[{"Join", "[", 
                  RowBox[{"theta1", ",", "phi1", ",", "theta2", ",", "phi2"}],
                   "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Module", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "psi1", ",", "psi2", ",", "psi", ",", "Spsi", ",", "norm2l", 
                  ",", "norm4", ",", "A", ",", "trace", ",", "measure", ",", 
                  "expr1", ",", "expr2"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"psi1", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "sinProduct", "}"}], ",", 
                    RowBox[{
                    RowBox[{"sinProduct", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"k", "==", "m"}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"theta1", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "k", ",", 
                    RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"k", "==", "1"}], ",", "sinProduct", " ", ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"theta1", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "-", "1"}], "]"}], "]"}], "]"}], 
                    "sinProduct", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", 
                    RowBox[{"phi1", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "-", "1"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"psi2", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "sinProduct", "}"}], ",", 
                    RowBox[{
                    RowBox[{"sinProduct", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"k", "==", "n"}], ",", "1", ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"theta2", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "k", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"k", "==", "1"}], ",", "sinProduct", ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"theta2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "-", "1"}], "]"}], "]"}], "]"}], 
                    "sinProduct", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", " ", 
                    RowBox[{"phi2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", "-", "1"}], "]"}], "]"}]}], "]"}]}]}], 
                    "]"}]}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"psi", "=", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"KroneckerProduct", "[", 
                    RowBox[{"psi1", ",", "psi2"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Spsi", "=", 
                  RowBox[{"S", ".", "psi"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"below", " ", "see", " ", "appendix", " ", 
                   RowBox[{"in", " ", "[", 
                    RowBox[{"Hu", ":", 
                    RowBox[{"2024", "hex"}]}], "]"}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"A", "=", 
                  RowBox[{"Partition", "[", 
                   RowBox[{"Spsi", ",", "n"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"norm2l", "=", 
                  RowBox[{
                   RowBox[{"ComplexExpand", "[", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"A", ".", 
                    RowBox[{"ConjugateTranspose", "[", "A", "]"}]}], "]"}], 
                    "]"}], "^", "l"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"norm4", "=", 
                  RowBox[{
                   RowBox[{"ComplexExpand", "[", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"A", ".", 
                    RowBox[{"ConjugateTranspose", "[", "A", "]"}]}], "]"}], 
                    "]"}], "^", "2"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"trace", "=", 
                  RowBox[{
                   RowBox[{"ComplexExpand", "[", 
                    RowBox[{"Tr", "[", 
                    RowBox[{"A", ".", 
                    RowBox[{"ConjugateTranspose", "[", "A", "]"}], ".", "A", 
                    ".", 
                    RowBox[{"ConjugateTranspose", "[", "A", "]"}]}], "]"}], 
                    "]"}], 
                   RowBox[{"norm2l", "/", "norm4"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"measure", "=", 
                  RowBox[{
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"theta1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"theta1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "i"}], "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], 
                   RowBox[{
                    RowBox[{"Factorial", "[", 
                    RowBox[{"m", "-", "1"}], "]"}], "/", 
                    RowBox[{"Pi", "^", 
                    RowBox[{"(", 
                    RowBox[{"m", "-", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"theta2", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], 
                   RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"theta2", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "i"}], "-", "1"}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], 
                   RowBox[{
                    RowBox[{"Factorial", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], "/", 
                    RowBox[{"Pi", "^", 
                    RowBox[{"(", 
                    RowBox[{"n", "-", "1"}], ")"}]}]}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"expr1", "=", " ", 
                  RowBox[{"trace", " ", "measure"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"expr2", "=", " ", 
                  RowBox[{"norm2l", " ", "measure"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"expr1", ",", "expr2"}], "}"}]}]}], "]"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "integration", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"limits", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "0", ",", 
                 RowBox[{"Pi", "/", "2"}]}], "}"}], "&"}], "/@", "theta1"}], 
             ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "0", ",", 
                 RowBox[{"Pi", "/", "2"}]}], "}"}], "&"}], "/@", "theta2"}], 
             ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "0", ",", 
                 RowBox[{"2", "Pi"}]}], "}"}], "&"}], "/@", "phi1"}], ")"}], 
            ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "0", ",", 
                 RowBox[{"2", "Pi"}]}], "}"}], "&"}], "/@", "phi2"}], ")"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"integral1", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Integrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"integrand", "[", 
                RowBox[{"theta1", ",", "phi1", ",", "theta2", ",", "phi2"}], 
                "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "##"}], "]"}], "&"}], "@@",
            "limits"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"integral2", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Integrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"integrand", "[", 
                RowBox[{"theta1", ",", "phi1", ",", "theta2", ",", "phi2"}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "##"}], "]"}], "&"}], "@@",
            "limits"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"integral1", "/", "integral2"}]}], "//", "Simplify"}]}]}], 
       "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.943504406116129*^9, 3.943504429396595*^9}, {
   3.9435044602305145`*^9, 3.943504543647318*^9}, {3.943504775203617*^9, 
   3.9435048100788116`*^9}, {3.943505087961628*^9, 3.9435051133830795`*^9}, {
   3.94350516111804*^9, 3.943505174492588*^9}, {3.943505336632965*^9, 
   3.9435053611960125`*^9}, {3.943516249403536*^9, 3.9435162532938423`*^9}, {
   3.9435162890352135`*^9, 3.9435164072423897`*^9}, {3.9435164428754864`*^9, 
   3.943516504278345*^9}, {3.943516566828554*^9, 3.9435165715242844`*^9}, {
   3.943516611542698*^9, 3.943516693506323*^9}, {3.9435168495904217`*^9, 
   3.943516893068468*^9}, {3.9435169382955513`*^9, 3.9435169797593555`*^9}, {
   3.943517029442005*^9, 3.9435171136270466`*^9}, {3.943517231446253*^9, 
   3.9435172380338535`*^9}, {3.9435179967758636`*^9, 
   3.9435180016085663`*^9}, {3.9435182626763268`*^9, 3.943518272209049*^9}, {
   3.943518381147455*^9, 3.9435183820923443`*^9}, {3.9435184296121597`*^9, 
   3.9435184529455338`*^9}, {3.9435196776583424`*^9, 3.943519686537405*^9}, {
   3.9447920459476967`*^9, 3.9447921868432007`*^9}, {3.944792219333193*^9, 
   3.944792271347454*^9}, {3.9447923667167187`*^9, 3.944792373745558*^9}, {
   3.9447924122725334`*^9, 3.9447924150729065`*^9}, {3.9447924905165634`*^9, 
   3.9447925231170006`*^9}, {3.944792571214054*^9, 3.9447926705312004`*^9}, {
   3.9447927512696095`*^9, 3.9447927600200596`*^9}, {3.944792811949234*^9, 
   3.944792812496977*^9}, {3.9447929328922024`*^9, 3.9447929345975323`*^9}, {
   3.944793049653757*^9, 3.944793052611189*^9}, {3.944793090390707*^9, 
   3.944793108946081*^9}, {3.944793310022028*^9, 3.9447933105007324`*^9}, 
   3.9447933700697975`*^9, {3.944793453424635*^9, 3.944793471255621*^9}, {
   3.944793515310753*^9, 3.9447935176291847`*^9}, {3.944793552630394*^9, 
   3.944793569172943*^9}, {3.9447936399080505`*^9, 3.9447936959372177`*^9}, {
   3.944793997695793*^9, 3.9447940103757668`*^9}, {3.9447943185586357`*^9, 
   3.944794372154972*^9}, {3.944803925471409*^9, 3.944803941907276*^9}, {
   3.944804016649719*^9, 3.944804033918442*^9}, {3.9448041325661144`*^9, 
   3.9448041399290543`*^9}, {3.9448047613177414`*^9, 
   3.9448048091884995`*^9}, {3.94480484467914*^9, 3.9448048597568893`*^9}, {
   3.9448049380458775`*^9, 3.9448049447657776`*^9}, {3.944808824833864*^9, 
   3.9448089181776257`*^9}, 3.9448825510932426`*^9, {3.944895626442358*^9, 
   3.9448956271148643`*^9}, 3.94489604233976*^9, {3.9449468281552887`*^9, 
   3.944946862562252*^9}, {3.944947609669817*^9, 3.944947678455614*^9}, {
   3.9449477255771885`*^9, 3.944947741243614*^9}, {3.9449477838136883`*^9, 
   3.944947850166214*^9}, {3.944947957816799*^9, 3.9449479603163414`*^9}, {
   3.944973021449301*^9, 3.944973030037081*^9}, {3.944983718654108*^9, 
   3.9449837426276417`*^9}, {3.944989733583971*^9, 3.9449897585402927`*^9}, {
   3.944989797424263*^9, 3.944989805534561*^9}, {3.9453267554105453`*^9, 
   3.9453267927928753`*^9}, {3.9454120317362213`*^9, 
   3.9454120579985447`*^9}, {3.945412409879692*^9, 3.945412435991913*^9}, {
   3.945412869272793*^9, 3.9454128912287807`*^9}, {3.945413060424759*^9, 
   3.9454130960812416`*^9}, {3.9454132184206963`*^9, 3.945413222394665*^9}, {
   3.945413288804907*^9, 3.945413307103327*^9}, {3.945414587720791*^9, 
   3.9454146435834656`*^9}, {3.945415032814497*^9, 3.9454150349999485`*^9}, {
   3.9454175405748863`*^9, 3.945417558638422*^9}, {3.9454175903680553`*^9, 
   3.9454175927363853`*^9}, {3.9454178170629616`*^9, 3.945417868445364*^9}, {
   3.9454181511367645`*^9, 3.9454181640484467`*^9}, 3.9454182538619766`*^9, {
   3.9454187706282654`*^9, 3.945418797577154*^9}, {3.9454195877348957`*^9, 
   3.94541960098687*^9}, {3.9454197067799225`*^9, 3.9454197275555725`*^9}, {
   3.945419800154936*^9, 3.9454198536393147`*^9}, {3.945419918133833*^9, 
   3.9454199241985893`*^9}, {3.9454200236411247`*^9, 3.945420041246998*^9}, {
   3.9454784820641613`*^9, 3.945478487609911*^9}, {3.9454787796945705`*^9, 
   3.945478781686987*^9}, {3.945479498892273*^9, 3.945479511162367*^9}, {
   3.9454808505298615`*^9, 3.9454808524298916`*^9}, {3.946522255094885*^9, 
   3.9465223173341293`*^9}, {3.9465252816502857`*^9, 3.9465252990055466`*^9}, 
   3.9465343228550434`*^9, 3.9465364101295815`*^9, {3.946538130486868*^9, 
   3.9465381317078247`*^9}, {3.946675657505537*^9, 3.94667566299378*^9}, {
   3.947911524859022*^9, 3.9479115254213867`*^9}, {3.949355056615032*^9, 
   3.949355057443186*^9}, {3.9554476393788433`*^9, 3.9554476524219666`*^9}, {
   3.9554478639342346`*^9, 3.9554479027006035`*^9}, {3.9554479368429356`*^9, 
   3.9554479936466503`*^9}, {3.9554480526699314`*^9, 
   3.9554480529502316`*^9}, {3.95544823948938*^9, 3.9554482417954655`*^9}, {
   3.9568284823968773`*^9, 3.956828510695713*^9}, {3.956828608111925*^9, 
   3.9568286083663387`*^9}, {3.956828661201195*^9, 3.9568286613666477`*^9}, {
   3.956828827385023*^9, 3.956828835226858*^9}, {3.9568294250712223`*^9, 
   3.9568294308130856`*^9}, {3.9568296685738735`*^9, 3.956829682414877*^9}, {
   3.956829890156172*^9, 3.956829898300823*^9}, {3.9568316620871735`*^9, 
   3.9568316623603706`*^9}, {3.9580111508714237`*^9, 
   3.9580111986075153`*^9}, {3.9580112403563557`*^9, 
   3.9580112472155247`*^9}, {3.958011304016268*^9, 3.9580113119170055`*^9}, {
   3.9580113486580696`*^9, 3.9580113742191906`*^9}, {3.9580114231933556`*^9, 
   3.9580114305334625`*^9}, {3.9580114632986164`*^9, 
   3.9580115279310074`*^9}, {3.958011857113693*^9, 3.9580118668885098`*^9}, {
   3.958011964849287*^9, 3.958012027743223*^9}, {3.9580120759207897`*^9, 
   3.9580120809111214`*^9}, {3.9580122740977383`*^9, 3.958012333902397*^9}, 
   3.9580125476820717`*^9, {3.958012633131302*^9, 3.958012641356823*^9}, {
   3.9580126756086025`*^9, 3.958012709209841*^9}, {3.958012761424412*^9, 
   3.9580127831472893`*^9}, {3.9580128192242393`*^9, 
   3.9580128194769135`*^9}, {3.9587961245660973`*^9, 
   3.9587961322685623`*^9}, {3.958959827527445*^9, 3.9589598914484234`*^9}, {
   3.9693978916940136`*^9, 3.969397894178137*^9}, {3.9701874647677746`*^9, 
   3.9701874659539013`*^9}},ExpressionUUID->"592671f8-90f5-f046-802a-\
ad102a4c82b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "1/2 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Cross]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\times", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3ab894a5-dbfd-c94c-9453-f93d3d74bf4e"],
 " 1/2 system"
}], "Section",
 CellChangeTimes->{{3.572909074547361*^9, 3.5729091119803343`*^9}, {
   3.572909144925314*^9, 3.5729091834760327`*^9}, 3.9432558160650425`*^9, {
   3.9432558489071407`*^9, 3.943255909099638*^9}, 3.9432577281514664`*^9, 
   3.94489662642235*^9},ExpressionUUID->"7c52857a-57ad-4ccc-8576-\
4bf82499c5c0"],

Cell["result see [Beane : 2018 oxh]", "Text",
 CellChangeTimes->{{3.943436595622402*^9, 3.9434366267571983`*^9}, {
   3.943436722453596*^9, 3.943436722794235*^9}, 3.9434386007171097`*^9, {
   3.9701873984712486`*^9, 
   3.9701874006211452`*^9}},ExpressionUUID->"b7d67dc2-6008-a14c-a2ab-\
9874def7b204"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"phase", " ", "shifts"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"delta0", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<0\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta1", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<1\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"delta01", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<0-1\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{
      RowBox[{"delta0", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta1", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta01", "\[Element]", "Reals"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "projectors", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P0", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "4"}], ",", "4"}], "]"}], "]"}], "-", 
      RowBox[{"JJ", "[", 
       RowBox[{
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}], ",", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"3", "/", "4"}], ",", "4"}], "]"}], "]"}], "+", 
      RowBox[{"JJ", "[", 
       RowBox[{
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}], ",", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"S", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{
      RowBox[{"P0", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "I", " ", "delta01"}], "]"}]}], "+", "P1"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"entanglement", " ", "power"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EP", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EPcalc", "[", 
        RowBox[{"S", ",", "2", ",", "2", ",", "2"}], "]"}], "/.", 
       RowBox[{"delta01", "->", 
        RowBox[{"delta0", "-", "delta1"}]}]}], "//", "Simplify"}], "//", 
     "PrintTime"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.9432559037328987`*^9, {3.9432559549997463`*^9, 3.943255971356346*^9}, {
   3.9432563955358887`*^9, 3.943256400573183*^9}, {3.9433062161708355`*^9, 
   3.943306353478548*^9}, {3.9433064099460564`*^9, 3.943306429195997*^9}, {
   3.943306576484682*^9, 3.943306655182667*^9}, {3.9433067138331738`*^9, 
   3.943306734250368*^9}, {3.943306779398567*^9, 3.9433068223804245`*^9}, {
   3.943306881358124*^9, 3.9433069254728947`*^9}, {3.9433074657576313`*^9, 
   3.943307488464716*^9}, {3.943307525456375*^9, 3.9433075281783333`*^9}, {
   3.9433076358316307`*^9, 3.9433076962387295`*^9}, {3.943307840584589*^9, 
   3.9433078455598373`*^9}, {3.9433081737829437`*^9, 
   3.9433081992887955`*^9}, {3.9433083253418407`*^9, 
   3.9433083256482525`*^9}, {3.943308472393223*^9, 3.943308484827154*^9}, 
   3.9433085369919662`*^9, {3.943308755814438*^9, 3.943308804797043*^9}, {
   3.943308940423834*^9, 3.9433089502181683`*^9}, {3.9433093983312855`*^9, 
   3.9433094122300873`*^9}, {3.943309457941864*^9, 3.943309463551878*^9}, {
   3.943323248022461*^9, 3.9433232556492386`*^9}, {3.9433255316753273`*^9, 
   3.9433255628613625`*^9}, {3.9433260059483185`*^9, 3.943326044294945*^9}, {
   3.943326077960169*^9, 3.94332610531464*^9}, {3.943330310943924*^9, 
   3.943330333017721*^9}, {3.9433311793325214`*^9, 3.9433311880023537`*^9}, {
   3.9433314497910976`*^9, 3.9433315076862183`*^9}, {3.9433325388917446`*^9, 
   3.943332591840597*^9}, {3.943332784131939*^9, 3.943332790307331*^9}, {
   3.9433329488898716`*^9, 3.943332952098215*^9}, {3.9433330257395573`*^9, 
   3.943333074966732*^9}, {3.943333299867655*^9, 3.9433333291272907`*^9}, {
   3.9433409822558346`*^9, 3.9433409842125854`*^9}, {3.9434206151108932`*^9, 
   3.9434207318544445`*^9}, {3.943420797373947*^9, 3.943420874597967*^9}, {
   3.9434209242457447`*^9, 3.9434209349478416`*^9}, {3.9434210014048595`*^9, 
   3.943421081549122*^9}, {3.943432399280964*^9, 3.9434324021318893`*^9}, {
   3.9434325555359993`*^9, 3.9434325911718845`*^9}, {3.9434326986612377`*^9, 
   3.9434327326303253`*^9}, {3.943432769031975*^9, 3.9434327869073353`*^9}, {
   3.943432862341284*^9, 3.943432900335373*^9}, {3.9434329500523643`*^9, 
   3.9434329659823456`*^9}, {3.943433118007015*^9, 3.943433127362505*^9}, {
   3.9434332287833977`*^9, 3.943433235583351*^9}, {3.943433291134815*^9, 
   3.9434333315135098`*^9}, 3.9434333838766327`*^9, {3.9434360095382175`*^9, 
   3.943436051628374*^9}, {3.943436140885887*^9, 3.943436158864847*^9}, {
   3.9434361926420517`*^9, 3.943436208970625*^9}, {3.9434366061570263`*^9, 
   3.943436606595133*^9}, {3.9435007724213448`*^9, 3.943500875383276*^9}, 
   3.9435011371607895`*^9, 3.943502266560808*^9, 3.9435024625893574`*^9, {
   3.9435034498138866`*^9, 3.943503453501631*^9}, {3.9435039247216015`*^9, 
   3.943503933362816*^9}, {3.943517134910097*^9, 3.943517138682871*^9}, {
   3.944793749069645*^9, 3.9447937667259407`*^9}, {3.94479439507806*^9, 
   3.944794406267338*^9}, {3.944804113614496*^9, 3.9448041191847363`*^9}, {
   3.9448041557007103`*^9, 3.944804164799753*^9}, 3.944880970389698*^9, {
   3.9448956817598915`*^9, 3.94489573016897*^9}, {3.9448957742134724`*^9, 
   3.9448958383295727`*^9}, {3.9448959790319633`*^9, 3.944895980612442*^9}, 
   3.9448960383314075`*^9, 3.944896195194908*^9, {3.944896419158434*^9, 
   3.9448964269830017`*^9}, 3.944897568961836*^9, {3.945326676048519*^9, 
   3.945326693196789*^9}, {3.945413438729973*^9, 3.945413460115553*^9}, {
   3.9454135402436943`*^9, 3.945413570312313*^9}, {3.945413782829857*^9, 
   3.9454137969392605`*^9}, {3.945413996716097*^9, 3.945414014500229*^9}, {
   3.9454140972070293`*^9, 3.9454140977390537`*^9}, {3.9479116980540905`*^9, 
   3.947911701475605*^9}, {3.95801299749807*^9, 3.9580129976147385`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"005158d0-d6f7-af42-a0d3-80250e8070c5"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "52.578125`", 
    "\[InvisibleSpace]", "\<\" seconds\"\>"}],
   SequenceForm["Time used: ", 52.578125, " seconds"],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{
  3.945412904869686*^9, 3.945413119121212*^9, 3.945413255016201*^9, 
   3.945413336311903*^9, 3.945413643683653*^9, 3.9454141926088314`*^9, 
   3.9454142549674015`*^9, 3.9454146683069096`*^9, 3.9454148578516655`*^9, 
   3.945415063302826*^9, 3.9454179867209625`*^9, 3.945418202775755*^9, 
   3.9454182728085175`*^9, 3.9454185630138683`*^9, 3.9454197506527805`*^9, 
   3.9454199706896725`*^9, 3.945478792081148*^9, 3.9454799088265133`*^9, 
   3.946522687630003*^9, 3.9465378964715824`*^9, 3.946538192508772*^9, 
   3.946539400385992*^9, 3.946597709445717*^9, 3.946675760497469*^9, 
   3.9466893552216997`*^9, 3.9472309529666214`*^9, {3.9568284980488033`*^9, 
   3.956828517279539*^9}, 3.9580130999477463`*^9, 3.969397953407694*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[24]:=",ExpressionUUID->"02bb415f-5b28-974a-8b25-\
ae011ea3e61f"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "6"], " ", 
   RowBox[{
    SuperscriptBox["sin", "2"], "(", 
    RowBox[{
     RowBox[{"2", " ", 
      SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Delta]", "\<\"1\"\>"]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.943332956097187*^9, 3.9433330597555885`*^9, {3.943333284590309*^9, 
   3.9433333399364967`*^9}, 3.9433410006932793`*^9, 3.943420935931999*^9, 
   3.9434210630510883`*^9, 3.9434323905011673`*^9, 3.943432474918648*^9, {
   3.943432562263668*^9, 3.9434325954123535`*^9}, {3.9434327090683613`*^9, 
   3.9434327361822777`*^9}, {3.943432774132023*^9, 3.943432789437599*^9}, 
   3.9434328747255173`*^9, 3.94343309704883*^9, 3.9434331282068043`*^9, 
   3.9434333191626587`*^9, 3.9434333510109596`*^9, 3.9434336131855106`*^9, 
   3.9434361339015236`*^9, 3.9434367732413673`*^9, 3.94343747009334*^9, {
   3.943500876726639*^9, 3.9435009414168606`*^9}, 3.9435009719826374`*^9, 
   3.943501401935663*^9, 3.9435025226316166`*^9, 3.9435025556427326`*^9, 
   3.943503174780348*^9, 3.94350325505542*^9, 3.9435033991691933`*^9, {
   3.943503450988571*^9, 3.94350345431534*^9}, 3.943503633626642*^9, 
   3.9435039341042633`*^9, 3.9435045762752724`*^9, 3.9435048144146175`*^9, 
   3.943505118151863*^9, 3.9435051645863037`*^9, 3.9435052995397816`*^9, 
   3.943505365148838*^9, {3.9435171213866234`*^9, 3.94351714027882*^9}, 
   3.94351727152664*^9, {3.943517991624304*^9, 3.943518006299761*^9}, 
   3.9435184590055485`*^9, 3.9447928253616467`*^9, 3.9447929393189335`*^9, 
   3.944793066242321*^9, 3.944793113717415*^9, {3.944793479717781*^9, 
   3.944793523717346*^9}, 3.9447936276474266`*^9, 3.9447943819529953`*^9, 
   3.944794936249283*^9, {3.94480410550354*^9, 3.9448041504352894`*^9}, 
   3.9448044767549496`*^9, 3.944881336437439*^9, 3.944882345749859*^9, 
   3.9448957613382072`*^9, 3.944895870373913*^9, 3.9448960312267513`*^9, 
   3.944896080710575*^9, 3.944896385263487*^9, 3.944896480002146*^9, 
   3.9449456119343414`*^9, 3.944947866490858*^9, 3.944948000587961*^9, 
   3.9449838510271816`*^9, 3.944983892820467*^9, 3.944989884922886*^9, 
   3.9449900904282055`*^9, 3.945326621367548*^9, 3.9453266666287003`*^9, 
   3.945326733926317*^9, 3.94532683816634*^9, 3.945412835363371*^9, 
   3.945412920508869*^9, 3.9454131546790276`*^9, 3.9454132711950417`*^9, 
   3.945413352292246*^9, 3.9454136615978184`*^9, 3.9454142097788563`*^9, 
   3.9454142719082527`*^9, 3.9454148256013527`*^9, 3.945415014715166*^9, 
   3.945415080731369*^9, 3.9454180025689106`*^9, 3.9454182191925545`*^9, 
   3.9454183256479015`*^9, 3.9454185876246204`*^9, 3.9454197680322933`*^9, 
   3.9454199874794407`*^9, 3.9454788888649654`*^9, 3.945479924491379*^9, 
   3.9465226876456375`*^9, 3.9465378964715824`*^9, 3.946538192508772*^9, 
   3.946539400385992*^9, 3.946597709476963*^9, 3.946675760513092*^9, 
   3.94668935523038*^9, 3.947230946167713*^9, {3.9568284980684433`*^9, 
   3.9568285172815247`*^9}, 3.9580130999597397`*^9, 3.969397953407694*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"7c33952a-7d17-1a4d-8fce-3ee82955916a"]
}, Open  ]],

Cell["neutron-neutron scattering (J=0), result see [Hu:2025lua]", "Text",
 CellChangeTimes->{{3.9557440791259956`*^9, 3.9557441080779667`*^9}, {
  3.9562134490138874`*^9, 3.956213457631325*^9}, {3.969398115397892*^9, 
  3.969398116257286*^9}, {3.97018741940201*^9, 
  3.970187420546852*^9}},ExpressionUUID->"8d04d27d-2357-4c40-b3a5-\
4a71cd5f8322"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "projectors", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"P0", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "4"}], ",", "4"}], "]"}], "]"}], "-", 
      RowBox[{"JJ", "[", 
       RowBox[{
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}], ",", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"3", "/", "4"}], ",", "4"}], "]"}], "]"}], "+", 
      RowBox[{"JJ", "[", 
       RowBox[{
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}], ",", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"S", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", "P0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"entanglement", " ", "power"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EP", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"EPcalc", "[", 
       RowBox[{"S", ",", "2", ",", "2", ",", "2"}], "]"}], "//", "Simplify"}],
      "//", "PrintTime"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9557440608001423`*^9, 3.9557440724843235`*^9}, {
  3.9557441227191505`*^9, 3.955744131057289*^9}, {3.9568287017606335`*^9, 
  3.9568287048066616`*^9}, {3.9568288428809223`*^9, 3.9568288432001095`*^9}, {
  3.9568293987383385`*^9, 3.9568293995097466`*^9}, {3.9568316737699566`*^9, 
  3.9568316741536884`*^9}, {3.958012094113346*^9, 3.9580120948828297`*^9}, {
  3.95801286365176*^9, 3.958012889638191*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"2a81755b-c1a3-da4c-b69b-927fb6c13dd5"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "19.609375`", 
    "\[InvisibleSpace]", "\<\" seconds\"\>"}],
   SequenceForm["Time used: ", 19.609375, " seconds"],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{{3.958012850465351*^9, 3.958012886691719*^9}, 
   3.9580130225008316`*^9, 3.969397980210184*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[32]:=",ExpressionUUID->"d1555ebc-0095-c045-8fce-\
f032a980ab57"],

Cell[BoxData[
 FormBox[
  FractionBox["1", "2"], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.955744134770422*^9, 3.9568285840783863`*^9, 3.956828630445835*^9, 
   3.956828674004593*^9, 3.956828718051695*^9, 3.9568288509411945`*^9, 
   3.95682959377841*^9, {3.9568296748197975`*^9, 3.9568296974585686`*^9}, 
   3.958012217604994*^9, 3.9580123400651264`*^9, 3.9580127468039494`*^9, {
   3.9580128504734344`*^9, 3.9580128866957016`*^9}, 3.9580130225048504`*^9, 
   3.969397980210184*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"ab921d20-c0ef-9f44-bb5a-8a91e7c73f52"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "1/2 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Cross]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\times", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b1a073a5-fda5-ab49-8188-2e1fecba8ab7"],
 " 1 system"
}], "Section",
 CellChangeTimes->{{3.9448966070684605`*^9, 3.9448966274713097`*^9}, {
  3.9448967096241703`*^9, 
  3.9448967120806217`*^9}},ExpressionUUID->"301202ac-d05d-d94e-9c2e-\
fd0dd4458f5b"],

Cell["result see [Beane:2021zvo]", "Text",
 CellChangeTimes->{{3.944896942723709*^9, 3.944896948168762*^9}, {
  3.9448973422874947`*^9, 3.9448973429919167`*^9}, {3.9479115574961967`*^9, 
  3.9479115580117474`*^9}, {3.9701874267549267`*^9, 
  3.9701874280381927`*^9}},ExpressionUUID->"19b91c73-ea93-b74f-8d15-\
598daacdc79f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"phase", " ", "shifts"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"delta12", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<1/2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta32", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<3/2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta1232", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<1/2-3/2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{
      RowBox[{"delta12", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta32", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta1232", "\[Element]", "Reals"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "projectors", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P12", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "3"}], ",", "6"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"2", "/", "3"}], 
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"1", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P32", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"2", "/", "3"}], ",", "6"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"2", "/", "3"}], 
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"1", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"S", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "6"}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{
      RowBox[{"P12", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "I", " ", "delta1232"}], "]"}]}], "+", "P32"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"entanglement", " ", "power"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EP", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EPcalc", "[", 
        RowBox[{"S", ",", "2", ",", "2", ",", "3"}], "]"}], "/.", 
       RowBox[{"delta1232", "->", 
        RowBox[{"delta12", "-", "delta32"}]}]}], "//", "Simplify"}], "//", 
     "PrintTime"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9448966465048027`*^9, 3.9448966547660217`*^9}, {
   3.944896966037359*^9, 3.944896967680113*^9}, {3.9448973920589943`*^9, 
   3.944897489231226*^9}, {3.944897529218254*^9, 3.944897602209507*^9}, {
   3.9449454742592583`*^9, 3.9449454821958065`*^9}, 3.9449456397202663`*^9, 
   3.9449458499191055`*^9, {3.944949079826086*^9, 3.9449490872291813`*^9}, {
   3.94497403569376*^9, 3.944974042474268*^9}, {3.9449744342668037`*^9, 
   3.944974496935896*^9}, {3.9449745907452793`*^9, 3.9449745944323807`*^9}, {
   3.9449837792758064`*^9, 3.9449837848562775`*^9}, {3.944983822610256*^9, 
   3.944983823126669*^9}, {3.944983912728071*^9, 3.9449839192378426`*^9}, {
   3.944989899796417*^9, 3.944989907134199*^9}, {3.945326958083273*^9, 
   3.945326974925209*^9}, {3.945413701768635*^9, 3.9454137079413815`*^9}, {
   3.9454138976743164`*^9, 3.945413941245598*^9}, 3.9454139856209183`*^9, {
   3.9454140232917423`*^9, 3.9454140409887447`*^9}, {3.945417886959751*^9, 
   3.9454178932970047`*^9}, {3.945418368076334*^9, 3.9454183795116405`*^9}, 
   3.9454185777842407`*^9, {3.945419822507572*^9, 3.9454198286208267`*^9}, {
   3.9454198781342297`*^9, 3.9454198786342087`*^9}, {3.945478467028742*^9, 
   3.9454784739481373`*^9}, {3.945478519629303*^9, 3.9454785221972446`*^9}, {
   3.945478642731289*^9, 3.945478643461748*^9}, {3.9454799347713337`*^9, 
   3.945479946411764*^9}, {3.9465228422233963`*^9, 3.9465228483041954`*^9}, {
   3.9479117138852825`*^9, 3.947911736211029*^9}, {3.9693977069664326`*^9, 
   3.9693977111034927`*^9}},ExpressionUUID->"548de324-d0b3-cc49-8735-\
7472ca2ed319"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "724.43859`", 
    "\[InvisibleSpace]", "\<\" seconds\"\>"}],
   SequenceForm["Time used: ", 724.43859, " seconds"],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.945479947111639*^9, 3.9465245595818768`*^9, 
  3.9465392710102844`*^9, 3.946690081840268*^9, 3.9472309263401623`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[39]:=",ExpressionUUID->"923c2dde-13d9-486d-b0d6-\
869bc843d9ea"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["8", "243"], " ", 
   RowBox[{
    SuperscriptBox["sin", "2"], "(", 
    RowBox[{
     SubscriptBox["\[Delta]", "\<\"1/2\"\>"], "-", 
     SubscriptBox["\[Delta]", "\<\"3/2\"\>"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"10", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"1/2\"\>"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"3/2\"\>"]}]}], ")"}]}], "+", "17"}], 
    ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.9449455733718243`*^9, 3.944945846014179*^9, 3.9449461370930786`*^9, 
   3.9449480687503757`*^9, 3.9449490546046352`*^9, 3.944974123022587*^9, 
   3.944974437188244*^9, 3.9449746021948376`*^9, {3.9449837869691525`*^9, 
   3.9449838287397575`*^9}, 3.9449866904181156`*^9, 3.9449897126204967`*^9, {
   3.944989909698555*^9, 3.94498996040658*^9}, 3.944990001799473*^9, 
   3.944990045008148*^9, {3.9453270553256283`*^9, 3.9453270762223625`*^9}, {
   3.9453271139607334`*^9, 3.9453271250301666`*^9}, {3.945327184343443*^9, 
   3.945327195920233*^9}, 3.9454136938187943`*^9, 3.945413878418558*^9, 
   3.9454145695709076`*^9, 3.9454175020151367`*^9, 3.9454175957247353`*^9, 
   3.9454177796186085`*^9, 3.945417895195156*^9, 3.9454180292955074`*^9, 
   3.945418381999958*^9, 3.9454185419363995`*^9, 3.9454187671548767`*^9, 
   3.9454195773941383`*^9, 3.945419697360388*^9, {3.945419863578377*^9, 
   3.945419885895012*^9}, {3.9454199455741577`*^9, 3.945419948734535*^9}, {
   3.945478513067793*^9, 3.945478523236929*^9}, {3.945479943766279*^9, 
   3.9454799476213436`*^9}, 3.9465245595818768`*^9, 3.9465392710102844`*^9, 
   3.946690081845497*^9, 3.9472309190521755`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"b8101fe9-e901-41da-8972-70dbc5a4bdc2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "1 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Cross]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\times", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "02e4a224-8374-f041-a180-5e71e75185b0"],
 " 1 system"
}], "Section",
 CellChangeTimes->{{3.943437526665228*^9, 3.9434375487370872`*^9}, 
   3.9448966281438694`*^9},ExpressionUUID->"3440cb14-8261-9249-8286-\
6d745d2155e5"],

Cell["result see [Kirchner:2023dvg]", "Text",
 CellChangeTimes->{{3.9434385230814686`*^9, 3.943438523562401*^9}, {
   3.943438572950001*^9, 3.9434385890627193`*^9}, {3.947903412482502*^9, 
   3.947903415154192*^9}, 3.956213414295639*^9, 3.9562136235630436`*^9, {
   3.970187434007059*^9, 
   3.9701874347550697`*^9}},ExpressionUUID->"aa22ea68-bb90-344c-af29-\
95dfbad1fd37"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"phase", " ", "shifts"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"delta0", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<0\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta1", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<1\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta2", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta01", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<0-1\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta21", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<2-1\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{
      RowBox[{"delta0", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta1", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta2", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta01", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta21", "\[Element]", "Reals"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "projectors", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P0", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "3"}], ",", "9"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"JJ", "[", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}], ",", "2"}], "]"}], 
       "/", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P1", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "9"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}], "/", "2"}], "-", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"JJ", "[", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}], ",", "2"}], "]"}], 
       "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P2", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "3"}], ",", "9"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}], "/", "2"}], "+", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"JJ", "[", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}], ",", "2"}], "]"}], 
       "/", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"S", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "9"}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{
      RowBox[{"P0", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "I", " ", "delta01"}], "]"}]}], "+", "P1", "+", 
      RowBox[{"P2", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "I", " ", "delta21"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"entanglement", " ", "power"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EP", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EPcalc", "[", 
        RowBox[{"S", ",", "2", ",", "3", ",", "3"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"delta01", "->", 
          RowBox[{"delta0", "-", "delta1"}]}], ",", 
         RowBox[{"delta21", "->", 
          RowBox[{"delta2", "-", "delta1"}]}]}], "}"}]}], "//", "Simplify"}], 
     "//", "PrintTime"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9434381880309696`*^9, 3.9434382233612976`*^9}, {
   3.9434382852394238`*^9, 3.943438502825001*^9}, {3.9434874633296795`*^9, 
   3.9434874637982693`*^9}, {3.9434879035838356`*^9, 
   3.9434879066540604`*^9}, {3.944805209729271*^9, 3.9448052446329803`*^9}, {
   3.9448808849991856`*^9, 3.9448809155585003`*^9}, {3.94488266357967*^9, 
   3.944882708754244*^9}, {3.944885014282501*^9, 3.944885017845726*^9}, {
   3.944896113848921*^9, 3.944896122079876*^9}, {3.9448961818284893`*^9, 
   3.9448962113930607`*^9}, {3.944896253755211*^9, 3.9448962848739204`*^9}, {
   3.9448964650985336`*^9, 3.9448964827245693`*^9}, 3.944911136774971*^9, {
   3.9449458578089066`*^9, 3.9449458656048393`*^9}, 3.9449459049081917`*^9, {
   3.945326988189434*^9, 3.945327014610483*^9}, {3.945414067028492*^9, 
   3.945414083773115*^9}, {3.9465363074206867`*^9, 3.946536314430628*^9}, {
   3.947911642554083*^9, 3.9479116452881794`*^9}, {3.969397716840063*^9, 
   3.969397717027542*^9}},ExpressionUUID->"59d63f80-8a15-1d4a-ad3a-\
2f886f5df6a8"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "12233.666079`", 
    "\[InvisibleSpace]", "\<\" seconds\"\>"}],
   SequenceForm["Time used: ", 12233.666079, " seconds"],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.9466120735671444`*^9, 3.946711613116211*^9, 
  3.9472309728454075`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[47]:=",ExpressionUUID->"04ab01b2-cf6a-40d0-a9d9-\
5ac4074de866"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "648"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"15", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Delta]", "\<\"0\"\>"], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["\[Delta]", "\<\"1\"\>"]}], "+", 
           SubscriptBox["\[Delta]", "\<\"2\"\>"]}], ")"}]}], ")"}]}]}], "-", 
     RowBox[{"6", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"1\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"65", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"10", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"60", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"1\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}], "+", "156"}], 
    ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.944808690951586*^9, 3.9448093698886337`*^9, 3.944815279685116*^9, {
   3.9448809089511166`*^9, 3.9448809217101707`*^9}, 3.9448815325080223`*^9, 
   3.944882572285494*^9, 3.9448826203119907`*^9, 3.9448850102457523`*^9, 
   3.944940575089325*^9, {3.944945870664629*^9, 3.9449459079860744`*^9}, 
   3.94494890331777*^9, 3.9449900536202774`*^9, 3.945327213543354*^9, 
   3.9454180483157597`*^9, 3.9454199394871674`*^9, {3.945479954261614*^9, 
   3.9454799569966526`*^9}, 3.9465365996855106`*^9, 3.946536890845875*^9, 
   3.9465380976155643`*^9, 3.9465498209218197`*^9, 3.9466120735984516`*^9, 
   3.946711613120816*^9, 3.947230981767658*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"1029d51e-49b0-4722-a36b-10758dd9cd55"]
}, Open  ]],

Cell["\<\
deuteron-deuteron scattering (J = 0, 2), result see [Hu:2025lua], different \
from [Kirchner:2023dvg]\
\>", "Text",
 CellChangeTimes->{{3.947903453728224*^9, 3.9479034798191032`*^9}, {
  3.9485062479826183`*^9, 3.9485062585745087`*^9}, {3.948512227768982*^9, 
  3.9485122356804466`*^9}, {3.948526026994255*^9, 3.9485260307282257`*^9}, {
  3.9562134295840855`*^9, 3.9562134372793694`*^9}, {3.956213492579832*^9, 
  3.9562135052999496`*^9}, {3.9693976231907883`*^9, 3.969397626815399*^9}, {
  3.969398095743162*^9, 3.9693980998989563`*^9}, {3.970187440969942*^9, 
  3.970187446470356*^9}},ExpressionUUID->"78725b81-14d1-e14e-8be9-\
2c55805141b3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"phase", " ", "shifts"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"delta0", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<0\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta2", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta02", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<0-2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{
      RowBox[{"delta0", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta2", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta02", "\[Element]", "Reals"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "projectors", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P0", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "3"}], ",", "9"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"JJ", "[", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}], ",", "2"}], "]"}], 
       "/", "3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P2", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "3"}], ",", "9"}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}], "/", "2"}], "+", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"JJ", "[", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
           RowBox[{"\[Sigma]", "[", "1", "]"}]}], "]"}], ",", "2"}], "]"}], 
       "/", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"S", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "9"}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{
      RowBox[{"P0", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "I", " ", "delta02"}], "]"}]}], "+", "P2"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"entanglement", " ", "power"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EP", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EPcalc", "[", 
        RowBox[{"S", ",", "2", ",", "3", ",", "3"}], "]"}], "/.", 
       RowBox[{"delta02", "->", 
        RowBox[{"delta0", "-", "delta2"}]}]}], "//", "Simplify"}], "//", 
     "PrintTime"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9479034274340763`*^9, 3.9479034427293186`*^9}, {
  3.9479035312784615`*^9, 3.9479035626971416`*^9}, {3.947903753387247*^9, 
  3.947903818124506*^9}, {3.9479116173536377`*^9, 3.9479116263526783`*^9}, {
  3.948506375546961*^9, 3.948506376047777*^9}, {3.969397722818222*^9, 
  3.9693977228963375`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"98a8c203-241a-8c4e-8451-a4a21af6996e"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "3459.265625`", 
    "\[InvisibleSpace]", "\<\" seconds\"\>"}],
   SequenceForm["Time used: ", 3459.265625, " seconds"],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.9694016503737335`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[36]:=",ExpressionUUID->"ed7ba960-53c2-954e-8860-\
9ee4e22322c4"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "594"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"20", " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{"4", " ", 
          SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
         RowBox[{"4", " ", 
          SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}]}], "-", 
     RowBox[{"70", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}], "+", "171"}], 
    ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9693976559797096`*^9, 3.969397879366503*^9, 
  3.9694016503787327`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"59618c1c-943b-4446-bbb3-7e3569f678bc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "1/2 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Cross]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\times", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "713a7093-1b79-0943-9008-e00e15730e94"],
 " 3/2 system"
}], "Section",
 CellChangeTimes->{{3.943257571944168*^9, 3.9432576769516373`*^9}, {
   3.943257711443695*^9, 3.9432577313609867`*^9}, 
   3.9454795876323643`*^9},ExpressionUUID->"17619733-9eaa-9b42-9434-\
acb682ed112b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delta1", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<1\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta2", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<2\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"delta12", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<1-2\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{
     RowBox[{"delta1", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta2", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta12", "\[Element]", "Reals"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "projectors", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"3", "/", "8"}], ",", "8"}], "]"}], "]"}], "-", 
    RowBox[{
     RowBox[{"JJ", "[", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"1", "/", "2"}], "]"}], ",", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}]}], "]"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "=", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"5", "/", "8"}], ",", "8"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"JJ", "[", 
       RowBox[{
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"1", "/", "2"}], "]"}], ",", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"3", "/", "2"}], "]"}]}], "]"}], "/", "2"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", "8"}], "]"}], "]"}]}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", 
    RowBox[{
     RowBox[{"P1", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", "I", " ", "delta12"}], "]"}]}], "+", "P2"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"entanglement", " ", "power"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"EP", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EPcalc", "[", 
      RowBox[{"S", ",", "2", ",", "4"}], "]"}], "/.", 
     RowBox[{"delta12", "->", 
      RowBox[{"delta1", "-", "delta2"}]}]}], "//", "Simplify"}], "//", 
   "PrintTime"}]}]}], "Input",
 CellChangeTimes->{{3.944804965430868*^9, 3.9448050192654552`*^9}, {
  3.94489866528294*^9, 3.9448986887112293`*^9}, {3.9449459838937397`*^9, 
  3.944945987908943*^9}, {3.9449901552146072`*^9, 3.9449901966217175`*^9}, {
  3.944990234172264*^9, 3.9449902833019314`*^9}, {3.9453270255827103`*^9, 
  3.9453270390188713`*^9}, {3.945414112655983*^9, 3.9454141237095547`*^9}, {
  3.9465247538178825`*^9, 3.946524760061247*^9}, {3.9479116609912853`*^9, 
  3.947911663506651*^9}},ExpressionUUID->"991a8b33-5403-b64b-9dd2-\
b49faefa0056"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "10568.609375`", 
    "\[InvisibleSpace]", "\<\" seconds\"\>"}],
   SequenceForm["Time used: ", 10568.609375, " seconds"],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.9465362237055798`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[31]:=",ExpressionUUID->"91eeaa86-f548-e140-b905-\
e7d80a86c714"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "32"], " ", 
   RowBox[{
    SuperscriptBox["sin", "2"], "(", 
    RowBox[{
     SubscriptBox["\[Delta]", "\<\"1\"\>"], "-", 
     SubscriptBox["\[Delta]", "\<\"2\"\>"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"11", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"1\"\>"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}], "+", "21"}], 
    ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.9448049776001015`*^9, 3.944805012263197*^9}, {
   3.944990277955469*^9, 3.9449902901637993`*^9}, 3.9453272084501476`*^9, 
   3.9454180517927017`*^9, 3.945419931564602*^9, 3.9465252758446884`*^9, 
   3.9465362237055798`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"f49a049f-8a18-ab43-b54c-33fed66e1335"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "1 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Cross]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\times", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2ffb0d0c-d51d-6148-9de2-e8ab3890de11"],
 " 3/2 system"
}], "Section",
 CellChangeTimes->{{3.952195788784355*^9, 
  3.952195820106617*^9}},ExpressionUUID->"4a1f91fa-5530-504d-8d5e-\
13b11119995a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"phase", " ", "shifts"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"delta12", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<1/2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta32", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<3/2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta52", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<5/2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta1232", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<1/2-3/2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"delta5232", "=", 
     RowBox[{"Subscript", "[", 
      RowBox[{"\[Delta]", ",", "\"\<5/2-3/2\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$Assumptions", "=", 
     RowBox[{
      RowBox[{"delta12", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta32", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta52", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta1232", "\[Element]", "Reals"}], "&&", 
      RowBox[{"delta5232", "\[Element]", "Reals"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "projectors", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P12", "=", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"1", "/", "4"}], ",", "12"}], "]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], "/", "12"}], "+", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"JJ", "[", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}], "/", 
       "6"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P32", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "12"}], "]"}], "]"}], "-", 
      RowBox[{"4", 
       RowBox[{
        RowBox[{"JJ", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}]}], "]"}], "/", "15"}]}], "-", 
      RowBox[{"4", 
       RowBox[{
        RowBox[{"MatrixPower", "[", 
         RowBox[{
          RowBox[{"JJ", "[", 
           RowBox[{
            RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
            RowBox[{"\[Sigma]", "[", 
             RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}], "/", 
        "15"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P52", "=", 
     RowBox[{
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "4"}], ",", "12"}], "]"}], "]"}], "+", 
      RowBox[{"7", 
       RowBox[{
        RowBox[{"JJ", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}]}], "]"}], "/", "20"}]}], "+", 
      RowBox[{
       RowBox[{"MatrixPower", "[", 
        RowBox[{
         RowBox[{"JJ", "[", 
          RowBox[{
           RowBox[{"\[Sigma]", "[", "1", "]"}], ",", 
           RowBox[{"\[Sigma]", "[", 
            RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}], "/", 
       "10"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"S", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "12"}], "]"}], "]"}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{
      RowBox[{"P12", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "I", " ", "delta1232"}], "]"}]}], "+", "P32", "+", 
      RowBox[{"P52", " ", 
       RowBox[{"Exp", "[", 
        RowBox[{"2", "I", " ", "delta5232"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"entanglement", " ", "power"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"EP", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"EPcalc", "[", 
        RowBox[{"S", ",", "2", ",", "3", ",", "4"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"delta1232", "->", 
          RowBox[{"delta12", "-", "delta32"}]}], ",", 
         RowBox[{"delta5232", "->", 
          RowBox[{"delta52", "-", "delta32"}]}]}], "}"}]}], "//", 
      "Simplify"}], "//", "PrintTime"}]}]}]}]], "Input",
 CellChangeTimes->{{3.9521959140283833`*^9, 3.9521959195989037`*^9}, {
   3.9521959635900116`*^9, 3.9521960019530525`*^9}, {3.9521960581972656`*^9, 
   3.9521963396095047`*^9}, {3.95219652053804*^9, 3.952196545475271*^9}, {
   3.9529165438215847`*^9, 3.9529165490646477`*^9}, 3.95561645421747*^9, {
   3.9693977719168224`*^9, 
   3.9693977721667976`*^9}},ExpressionUUID->"4815f627-f830-3645-915b-\
7aebbab3d6ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "3/2 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Cross]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\times", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "f3c52243-4410-ac4a-bc59-4b0fa0dfe0f6"],
 " 3/2 system"
}], "Section",
 CellChangeTimes->{{3.945478916351677*^9, 3.9454789219152985`*^9}, {
  3.9454795829527397`*^9, 
  3.9454795860324974`*^9}},ExpressionUUID->"cd83b4b3-5a7a-5f40-a6bc-\
7ec7401e680e"],

Cell["result see [Hu:2025lua]", "Text",
 CellChangeTimes->{
  3.96939808024341*^9, {3.9701875033038845`*^9, 
   3.970187505149597*^9}},ExpressionUUID->"1926b78a-dd22-5947-bfa8-\
7f198388877a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"delta0", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<0\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta1", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<1\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta2", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<2\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"delta3", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<3\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta03", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<0-3\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta13", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<1-3\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta23", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<2-3\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{
     RowBox[{"delta0", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta1", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta2", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta3", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta03", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta13", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta23", "\[Element]", "Reals"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "projectors", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P0", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"33", "/", "128"}], ",", "16"}], "]"}], "]"}], "+", 
    RowBox[{
     RowBox[{"31", "/", "96"}], 
     RowBox[{"JJ", "[", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}], ",", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"5", "/", "72"}], 
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "3"}], "]"}], "/", 
     "18"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "81"}], "/", "128"}], ",", "16"}], "]"}], "]"}], "-", 
    RowBox[{
     RowBox[{"117", "/", "160"}], 
     RowBox[{"JJ", "[", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}], ",", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"9", "/", "40"}], 
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "3"}], "]"}], "/", 
     "10"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P2", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"165", "/", "128"}], ",", "16"}], "]"}], "]"}], "+", 
    RowBox[{
     RowBox[{"23", "/", "96"}], 
     RowBox[{"JJ", "[", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}], ",", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"17", "/", "72"}], 
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "3"}], "]"}], "/", 
     "18"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "=", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"11", "/", "128"}], ",", "16"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"27", "/", "160"}], 
      RowBox[{"JJ", "[", 
       RowBox[{
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"3", "/", "2"}], "]"}], ",", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"3", "/", "2"}], "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"29", "/", "360"}], 
      RowBox[{"MatrixPower", "[", 
       RowBox[{
        RowBox[{"JJ", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"MatrixPower", "[", 
       RowBox[{
        RowBox[{"JJ", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "3"}], "]"}], "/", 
      "90"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", "16"}], "]"}], "]"}]}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", 
    RowBox[{
     RowBox[{"P0", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", "I", " ", "delta03"}], "]"}]}], "+", 
     RowBox[{"P1", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", "I", " ", "delta13"}], "]"}]}], "+", 
     RowBox[{"P2", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", "I", " ", "delta23"}], "]"}]}], "+", "P3"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"entanglement", " ", "power"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"EP", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EPcalc", "[", 
      RowBox[{"S", ",", "2", ",", "4", ",", "4"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"delta03", "->", 
        RowBox[{"delta0", "-", "delta3"}]}], ",", 
       RowBox[{"delta13", "->", 
        RowBox[{"delta1", "-", "delta3"}]}], ",", 
       RowBox[{"delta23", "->", 
        RowBox[{"delta2", "-", "delta3"}]}]}], "}"}]}], "//", "Simplify"}], "//",
    "PrintTime"}]}]}], "Input",
 CellChangeTimes->{
  3.9454795734427357`*^9, {3.945479614542368*^9, 3.9454798444116154`*^9}, {
   3.9454800127216854`*^9, 3.9454803182631817`*^9}, {3.9464492160387974`*^9, 
   3.946449220452633*^9}, {3.9466175697535496`*^9, 3.9466175775495777`*^9}, {
   3.9466755227794094`*^9, 3.9466755638596344`*^9}, {3.9479116702090645`*^9, 
   3.9479116725837765`*^9}, {3.969397777666176*^9, 
   3.969397777838087*^9}},ExpressionUUID->"6d30a862-75be-a941-8f09-\
3b43ba79515c"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\"Time used: \"\>", "\[InvisibleSpace]", "259706.69859`", 
    "\[InvisibleSpace]", "\<\" seconds\"\>"}],
   SequenceForm["Time used: ", 259706.69859, " seconds"],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.946970534894178*^9, 3.947039797921324*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1aIn[58]:=",ExpressionUUID->"a5688c34-1cee-4ff5-9218-\
5073784a9947"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "200000"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"2100", " ", 
       RowBox[{"cos", "(", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Delta]", "\<\"0\"\>"], "+", 
           SubscriptBox["\[Delta]", "\<\"1\"\>"], "-", 
           SubscriptBox["\[Delta]", "\<\"2\"\>"], "-", 
           SubscriptBox["\[Delta]", "\<\"3\"\>"]}], ")"}]}], ")"}]}]}], "-", 
     RowBox[{"2100", " ", 
      RowBox[{"cos", "(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Delta]", "\<\"0\"\>"], "-", 
          SubscriptBox["\[Delta]", "\<\"1\"\>"], "+", 
          SubscriptBox["\[Delta]", "\<\"2\"\>"], "-", 
          SubscriptBox["\[Delta]", "\<\"3\"\>"]}], ")"}]}], ")"}]}], "-", 
     RowBox[{"2100", " ", 
      RowBox[{"cos", "(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Delta]", "\<\"0\"\>"], "-", 
          SubscriptBox["\[Delta]", "\<\"1\"\>"], "-", 
          SubscriptBox["\[Delta]", "\<\"2\"\>"], "+", 
          SubscriptBox["\[Delta]", "\<\"3\"\>"]}], ")"}]}], ")"}]}], "-", 
     RowBox[{"1200", " ", 
      RowBox[{"cos", "(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Delta]", "\<\"0\"\>"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Delta]", "\<\"1\"\>"]}], "+", 
          SubscriptBox["\[Delta]", "\<\"2\"\>"]}], ")"}]}], ")"}]}], "-", 
     RowBox[{"375", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"1\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"4200", " ", 
      RowBox[{"cos", "(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Delta]", "\<\"0\"\>"], "+", 
          SubscriptBox["\[Delta]", "\<\"2\"\>"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Delta]", "\<\"3\"\>"]}]}], ")"}]}], ")"}]}], "-", 
     RowBox[{"10800", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"625", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"875", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"0\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"3\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"8400", " ", 
      RowBox[{"cos", "(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["\[Delta]", "\<\"1\"\>"], "-", 
          RowBox[{"2", " ", 
           SubscriptBox["\[Delta]", "\<\"2\"\>"]}], "+", 
          SubscriptBox["\[Delta]", "\<\"3\"\>"]}], ")"}]}], ")"}]}], "-", 
     RowBox[{"2175", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"1\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"26376", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"1\"\>"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["\[Delta]", "\<\"3\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"5481", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"1\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"3\"\>"]}]}], ")"}]}], "-", 
     RowBox[{"10675", " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"2\"\>"]}], "-", 
        RowBox[{"4", " ", 
         SubscriptBox["\[Delta]", "\<\"3\"\>"]}]}], ")"}]}], "+", "77482"}], 
    ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{3.9469705349269743`*^9, 3.947039813111204*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"0a083b33-4f99-44ff-97dd-245dbe735b26"]
}, Open  ]],

Cell["Omega-Omega scattering (J = 0, 2), result see [Hu:2025lua]", "Text",
 CellChangeTimes->{{3.948506294087055*^9, 3.9485063159515095`*^9}, 
   3.9485122614495583`*^9, {3.956213668802187*^9, 3.956213679293947*^9}, {
   3.9693980380435905`*^9, 3.9693980577275543`*^9}, {3.970187509336132*^9, 
   3.9701875113678894`*^9}},ExpressionUUID->"a5b7f1ee-5a6b-e94a-85a3-\
443a91674d7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"delta0", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<0\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"delta2", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<2\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"delta02", "=", 
   RowBox[{"Subscript", "[", 
    RowBox[{"\[Delta]", ",", "\"\<0-2\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$Assumptions", "=", 
    RowBox[{
     RowBox[{"delta0", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta2", "\[Element]", "Reals"}], "&&", 
     RowBox[{"delta02", "\[Element]", "Reals"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "projectors", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P0", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"33", "/", "128"}], ",", "16"}], "]"}], "]"}], "+", 
    RowBox[{
     RowBox[{"31", "/", "96"}], 
     RowBox[{"JJ", "[", 
      RowBox[{
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}], ",", 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"3", "/", "2"}], "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"5", "/", "72"}], 
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"MatrixPower", "[", 
      RowBox[{
       RowBox[{"JJ", "[", 
        RowBox[{
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}], ",", 
         RowBox[{"\[Sigma]", "[", 
          RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "3"}], "]"}], "/", 
     "18"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "=", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"165", "/", "128"}], ",", "16"}], "]"}], "]"}], "+", 
     RowBox[{
      RowBox[{"23", "/", "96"}], 
      RowBox[{"JJ", "[", 
       RowBox[{
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"3", "/", "2"}], "]"}], ",", 
        RowBox[{"\[Sigma]", "[", 
         RowBox[{"3", "/", "2"}], "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"17", "/", "72"}], 
      RowBox[{"MatrixPower", "[", 
       RowBox[{
        RowBox[{"JJ", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "2"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"MatrixPower", "[", 
       RowBox[{
        RowBox[{"JJ", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}], ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"3", "/", "2"}], "]"}]}], "]"}], ",", "3"}], "]"}], "/", 
      "18"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"S", "-", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"S", "=", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", "16"}], "]"}], "]"}]}], ";"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "=", 
    RowBox[{
     RowBox[{"P0", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"2", "I", " ", "delta02"}], "]"}]}], "+", "P2"}]}], " ", ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"entanglement", " ", "power"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"EP", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"EPcalc", "[", 
      RowBox[{"S", ",", "2", ",", "4", ",", "4"}], "]"}], "/.", 
     RowBox[{"delta02", "->", 
      RowBox[{"delta0", "-", "delta2"}]}]}], "//", "Simplify"}], "//", 
   "PrintTime"}]}]}], "Input",
 CellChangeTimes->{
  3.9454795734427357`*^9, {3.945479614542368*^9, 3.9454798444116154`*^9}, {
   3.9454800127216854`*^9, 3.9454803182631817`*^9}, {3.9464492160387974`*^9, 
   3.946449220452633*^9}, {3.9466175697535496`*^9, 3.9466175775495777`*^9}, {
   3.9466755227794094`*^9, 3.9466755638596344`*^9}, {3.9479116702090645`*^9, 
   3.9479116725837765`*^9}, {3.948506325005764*^9, 3.948506352179367*^9}, {
   3.948506394417145*^9, 3.9485064270407715`*^9}, {3.969397781962637*^9, 
   3.969397782165657*^9}},ExpressionUUID->"22576583-e63b-d642-a470-\
0ef2633ff9d6"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141.2, 579.6},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>1. Inherited,
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (2024\:5e747\:670816\
\:65e5)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"192093e1-ac88-4c45-b320-ea316bb28639"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 262, 5, 68, "Title",ExpressionUUID->"62d9c5db-de1f-9a47-b9cd-cb2e49d0552e"],
Cell[844, 29, 158, 3, 40, "Author",ExpressionUUID->"723aa07e-624e-fa43-a9c3-c33090ecb45f"],
Cell[1005, 34, 155, 3, 42, "Date",ExpressionUUID->"74f11d97-fcb1-d141-bf08-3e68d5341a77"],
Cell[1163, 39, 225, 3, 53, "Input",ExpressionUUID->"e954a9e0-d0e2-46af-a905-7ced7dc10471"],
Cell[CellGroupData[{
Cell[1413, 46, 165, 3, 68, "Section",ExpressionUUID->"98b4a004-41dd-7f40-8617-2f1d5a738672"],
Cell[CellGroupData[{
Cell[1603, 53, 171, 3, 33, "Subsection",ExpressionUUID->"2c353790-d81e-574e-8fad-aacfcb0da47f"],
Cell[1777, 58, 1106, 23, 88, "Input",ExpressionUUID->"8b1dcab6-39f3-594d-8aaf-6d538be5d8b0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2932, 87, 210, 4, 68, "Section",ExpressionUUID->"223357e4-6f64-457b-bba5-59cdca655b8d"],
Cell[CellGroupData[{
Cell[3167, 95, 134, 3, 33, "Subsection",ExpressionUUID->"9ca0a207-aaf5-1f4a-a843-5e1b600fc46f"],
Cell[3304, 100, 2679, 67, 270, "Input",ExpressionUUID->"26956892-69bf-4a1e-bcc2-b9178ce5f14d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6020, 172, 165, 3, 33, "Subsection",ExpressionUUID->"c189ece0-bb0d-f54e-9def-3a0a613d6f9b"],
Cell[6188, 177, 809, 19, 109, "Input",ExpressionUUID->"f53db56d-8a57-4249-88da-92c99cfb528e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7046, 202, 229, 4, 68, "Section",ExpressionUUID->"ee20c56c-3c27-ef4e-97cd-522ad387f88d"],
Cell[7278, 208, 20410, 414, 1072, "Input",ExpressionUUID->"592671f8-90f5-f046-802a-ad102a4c82b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27725, 627, 626, 15, 68, "Section",ExpressionUUID->"7c52857a-57ad-4ccc-8576-4bf82499c5c0"],
Cell[28354, 644, 302, 5, 32, "Text",ExpressionUUID->"b7d67dc2-6008-a14c-a2ab-9874def7b204"],
Cell[CellGroupData[{
Cell[28681, 653, 6625, 134, 395, "Input",ExpressionUUID->"005158d0-d6f7-af42-a0d3-80250e8070c5"],
Cell[35309, 789, 1124, 20, 21, "Print",ExpressionUUID->"02bb415f-5b28-974a-8b25-ae011ea3e61f"],
Cell[36436, 811, 3135, 50, 53, "Output",ExpressionUUID->"7c33952a-7d17-1a4d-8fce-3ee82955916a"]
}, Open  ]],
Cell[39586, 864, 348, 5, 32, "Text",ExpressionUUID->"8d04d27d-2357-4c40-b3a5-4a71cd5f8322"],
Cell[CellGroupData[{
Cell[39959, 873, 2231, 58, 219, "Input",ExpressionUUID->"2a81755b-c1a3-da4c-b69b-927fb6c13dd5"],
Cell[42193, 933, 489, 11, 21, "Print",ExpressionUUID->"d1555ebc-0095-c045-8fce-f032a980ab57"],
Cell[42685, 946, 572, 10, 53, "Output",ExpressionUUID->"ab921d20-c0ef-9f44-bb5a-8a91e7c73f52"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43306, 962, 505, 14, 68, "Section",ExpressionUUID->"301202ac-d05d-d94e-9c2e-fd0dd4458f5b"],
Cell[43814, 978, 324, 5, 32, "Text",ExpressionUUID->"19b91c73-ea93-b74f-8d15-598daacdc79f"],
Cell[CellGroupData[{
Cell[44163, 987, 4484, 107, 395, "Input",ExpressionUUID->"548de324-d0b3-cc49-8735-7472ca2ed319"],
Cell[48650, 1096, 512, 11, 21, "Print",ExpressionUUID->"923c2dde-13d9-486d-b0d6-869bc843d9ea"],
Cell[49165, 1109, 1840, 36, 53, "Output",ExpressionUUID->"b8101fe9-e901-41da-8972-70dbc5a4bdc2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51054, 1151, 473, 13, 68, "Section",ExpressionUUID->"3440cb14-8261-9249-8286-6d745d2155e5"],
Cell[51530, 1166, 374, 6, 32, "Text",ExpressionUUID->"aa22ea68-bb90-344c-af29-95dfbad1fd37"],
Cell[CellGroupData[{
Cell[51929, 1176, 5526, 144, 501, "Input",ExpressionUUID->"59d63f80-8a15-1d4a-ad3a-2f886f5df6a8"],
Cell[57458, 1322, 472, 11, 21, "Print",ExpressionUUID->"04ab01b2-cf6a-40d0-a9d9-5ac4074de866"],
Cell[57933, 1335, 2234, 55, 53, "Output",ExpressionUUID->"1029d51e-49b0-4722-a36b-10758dd9cd55"]
}, Open  ]],
Cell[60182, 1393, 654, 11, 32, "Text",ExpressionUUID->"78725b81-14d1-e14e-8be9-2c55805141b3"],
Cell[CellGroupData[{
Cell[60861, 1408, 3531, 97, 395, "Input",ExpressionUUID->"98a8c203-241a-8c4e-8451-a4a21af6996e"],
Cell[64395, 1507, 421, 10, 21, "Print",ExpressionUUID->"ed7ba960-53c2-954e-8860-9ee4e22322c4"],
Cell[64819, 1519, 839, 24, 53, "Output",ExpressionUUID->"59618c1c-943b-4446-bbb3-7e3569f678bc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65707, 1549, 529, 14, 68, "Section",ExpressionUUID->"17619733-9eaa-9b42-9434-acb682ed112b"],
Cell[CellGroupData[{
Cell[66261, 1567, 3179, 91, 376, "Input",ExpressionUUID->"991a8b33-5403-b64b-9dd2-b49faefa0056"],
Cell[69443, 1660, 423, 10, 21, "Print",ExpressionUUID->"91eeaa86-f548-e140-b905-e7d80a86c714"],
Cell[69869, 1672, 889, 23, 53, "Output",ExpressionUUID->"f49a049f-8a18-ab43-b54c-33fed66e1335"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[70807, 1701, 448, 13, 68, "Section",ExpressionUUID->"4a1f91fa-5530-504d-8d5e-13b11119995a"],
Cell[71258, 1716, 5418, 150, 501, "Input",ExpressionUUID->"4815f627-f830-3645-915b-7aebbab3d6ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76713, 1871, 505, 14, 68, "Section",ExpressionUUID->"cd83b4b3-5a7a-5f40-a6bc-7ec7401e680e"],
Cell[77221, 1887, 192, 4, 32, "Text",ExpressionUUID->"1926b78a-dd22-5947-bfa8-7f198388877a"],
Cell[CellGroupData[{
Cell[77438, 1895, 8079, 238, 729, "Input",ExpressionUUID->"6d30a862-75be-a941-8f09-3b43ba79515c"],
Cell[85520, 2135, 443, 10, 21, "Print",ExpressionUUID->"a5688c34-1cee-4ff5-9218-5073784a9947"],
Cell[85966, 2147, 4391, 119, 91, "Output",ExpressionUUID->"0a083b33-4f99-44ff-97dd-245dbe735b26"]
}, Open  ]],
Cell[90372, 2269, 379, 5, 32, "Text",ExpressionUUID->"a5b7f1ee-5a6b-e94a-85a3-443a91674d7c"],
Cell[90754, 2276, 4606, 132, 447, "Input",ExpressionUUID->"22576583-e63b-d642-a470-0ef2633ff9d6"]
}, Open  ]]
}, Open  ]]
}
]
*)

